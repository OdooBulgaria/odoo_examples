<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="sale.report_saleorder_document">
            <!-- Multicompany -->
            <t t-if="o and 'company_id' in o">
                <t t-set="company" t-value="o.company_id"></t>
            </t>
            <t t-if="not o or not 'company_id' in o">
                <t t-set="company" t-value="res_company"></t>
            </t>
            <div class="header">
              <div class="row">
                <div class="col-xs-4">
                  <h1>
                    <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo"
                         style="max-height: 105px;"/>
                  </h1>
                </div>
                <div class="col-xs-4 text-right">
                  <span t-field="company.name"/><span t-if="company.rml_header1"> -
                    <span t-field="company.rml_header1" /></span><br />
                  <span t-if="company.street"><span t-field="company.street"/></span>
                    <span t-if="company.street2"/><span t-field="company.street2"></span><br />
                  <span t-if="company.zip"><span t-field="company.zip"/>, </span>
                    <span t-if="company.city"><span t-field="company.city"/> - </span><span t-if="company.state_id">(<span t-field="company.state_id.code"/>), </span><span t-if="company.country_id"><span t-field="company.country_id.name"/></span><br />
                  <span t-if="company.vat">PI: <span t-field="company.vat"/></span>
                </div>
                <div class="col-xs-4 text-right">
                  <span t-if="company.phone">Tel: <span t-field="company.phone"/></span><br />
                  <span t-if="company.fax">Fax: <span t-field="company.fax"/></span><br />
                  <span t-if="company.email">email: <span t-field="company.email"/></span><br />
                  <span t-if="company.website">web: <span t-field="company.website"/></span>
                </div>
              </div>
            </div>
            <div class="page">
                    <div class="row">
                        <div class="col-xs-6">
                        </div>
                        <div t-if="o.picking_ids.ddt_id" class="col-xs-6 text-right">
                            <h1>Documento di Trasporto</h1>
                            <h1>
                                <small> DDT #<span t-field="o.picking_ids.ddt_id.name"/>
                                        del
                                        <span t-field="o.picking_ids.ddt_id.date" t-field-options='{"format": "d/M/y"}'/>
                                </small>
                            </h1>
                        </div>
                        <div t-if=" not o.picking_ids.ddt_id" class="col-xs-6 text-right">
                            <h1>Preventivo / Ordine</h1>
                            <h1>
                                <small> Numero #<span t-field="o.name"/>
                                        del
                                    <span t-field="o.date_order" t-field-options='{"format": "d/M/y"}'/>
                                </small>
                            </h1>
                        </div>
                      </div>
                    <div class="row">
                        <div class="col-xs-6">
                            <table class="table table-condensed">
                                <thead>
                                    <tr>
                                        <th><h4>Fatturazione</h4></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <div t-field="o.partner_invoice_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;, &quot;fax&quot;], &quot;no_marker&quot;: true}"/>
                                            <span t-if="o.partner_id.vat">Partita IVA: <span t-field="o.partner_id.vat"/><br /></span>
                                            <span t-if="o.partner_id.fiscalcode">Codice Fiscale: <span t-field="o.partner_id.fiscalcode"/><br /></span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="col-xs-6 text-right">
                            <table class="table table-condensed text-right">
                                <thead>
                                    <tr class="text-right">
                                        <th><h4>Spedizione</h4></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td t-if="o.partner_shipping_id != o.partner_invoice_id">
                                            <div t-field="o.partner_shipping_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;, &quot;fax&quot;], &quot;no_marker&quot;: true}"/>
                                        </td>
                                        <td t-if="o.partner_shipping_id == o.partner_invoice_id">
                                            <div t-field="o.partner_invoice_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;, &quot;name&quot;, &quot;phone&quot;, &quot;fax&quot;], &quot;no_marker&quot;: true}"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-xs-12">
                            <div t-if="o.client_order_ref" class="col-xs-3">
                                <strong>Vostro Riferimento:</strong>
                                <p t-field="o.client_order_ref"/>
                            </div>
                            <div t-if="o.date_order" class="col-xs-3">
                                <strong t-if="o.state not in ['draft','sent']">Data Ordine:</strong>
                                <strong t-if="o.state in ['draft','sent']">Data Preventivo:</strong>
                                <p t-field="o.date_order"/>
                            </div>
                            <div t-if="o.user_id.name" class="col-xs-3">
                                <strong>Commerciale:</strong>
                                <p t-field="o.user_id.name"/>
                            </div>
                            <div t-if="o.name" class="col-xs-3">
                                <strong>Numero Ordine:</strong>
                                <p t-field="o.name"/>
                            </div>
                        </div>
                    </div>
                    <table class="table table-condensed">
                        <thead>
                          <tr>
                            <th width="45%">
                              <h4>Prodotto e Descrizione</h4>
                            </th>
                            <th class="text-right">
                              <h4>Quantit√†</h4>
                            </th>
                            <th class="text-right">
                              <h4>Prezzo</h4>
                            </th>
                            <th class="text-right">
                              <h4>Sconto</h4>
                            </th>
                            <th class="text-right">
                              <h4>Imposte</h4>
                            </th>
                            <th class="text-right">
                              <h4>Totale</h4>
                            </th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr t-foreach="o.order_line" t-as="l">
                            <td><span t-field="l.name"/></td>
                            <td class="text-right">
                                                        <t t-esc="'{:.0f}'.format(l.product_uom_qty)"/><br />
                                <span groups="product.group_uom" t-field="l.product_uom"/>
                            </td>
                            <td class="text-right">
                                <span t-field="l.price_unit" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                            </td>
                            <td class="text-right" groups="sale.group_discount_per_so_line"><span t-field="l.discount" t-field-options="{&quot;widget&quot;: &quot;float&quot;}"/></td>
                            <td class="text-right">
                                <span t-esc="', '.join(map(lambda x: x.name, l.tax_id))"/>
                            </td>
                            <td class="text-right">
                                <span t-field="l.price_subtotal" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                            </td>
                        </tr>
                        </tbody>
                      </table>
                    <div class="row">
                        <div class="col-xs-5">

                        </div>
                        <div class="col-xs-2 col-xs-offset-3 text-right">
                          <p>
                            <strong>
                            Imponibile: <br />
                            Imposte: <br />
                            <h3>Totale: </h3><br />
                            </strong>
                          </p>
                        </div>
                        <div class="col-xs-2 text-right">
                          <strong>
                          <span t-field="o.amount_untaxed" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/><br />
                          <span t-field="o.amount_tax" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/><br />
                          <h3><span t-field="o.amount_total" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/></h3><br />
                          </strong>
                        </div>
                      </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <table class="table table-condensed">
                                <thead>
                                    <tr>
                                        <th><h4>Note</h4></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <span t-if="o.partner_id.total_credit &gt; 0">
                                                Ad oggi il suo debito nei nostri confronti ammonta a:
                                                                                       <span t-field="o.partner_id.total_credit" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/><br />
                                            </span>
                                            <span t-if="o.note">
                                                <span t-field="o.note" />
                                            </span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            <div class="footer">
                <div class="row">
                    <div class="col-xs-12">

                    <table class="table table-condensed table-bordered">
                            <tr>
                                <td>
                                    <h4>Causale del Trasporto</h4>
                                    <div t-field="o.transportation_reason_id"> VENDITA</div>
                                </td>
                                <td>
                                    <h4>Trasporto a Cura</h4>
                                    <div class="signature">MITTENTE</div>
                                </td>
                                <td>
                                    <h4>Firma del Mittente</h4>
                                    <div class="signature"></div>
                                </td>
                                <td>
                                    <h4>Firma per Accettazione</h4>
                                    <div class="signature"></div>
                                </td>
                            </tr>
                      </table>

                      </div>
                    <div class="col-xs-12">
                        <p align="center">
                            <span t-field="company.name"/> -
                            <span t-if="company.street"><span t-field="company.street"/>
                            </span><span t-if="company.street2"/><span t-field="company.street2"></span>,
                            <span t-if="company.zip"><span t-field="company.zip"/>, </span>
                            <span t-if="company.city"><span t-field="company.city"/> -
                            </span><span t-if="company.state_id">(<span t-field="company.state_id.code"/>),
                            </span><span t-if="company.country_id"><span t-field="company.country_id.name"/></span> -
                            <span t-if="company.vat">PI: <span t-field="company.vat"/></span> -
                            <span t-if="company.company_registry">REA: <span t-field="company.company_registry"/></span> -
                            <span t-if="'capitale_sociale' in o and company.capitale_sociale">Capitale Sociale <span t-field="company.capitale_sociale"/></span>
                         </p>
                        <p align="center"> Pagina <span class="page"/> di <span class="topage"/></p>
                    </div>
                </div>
            </div>
        </template>
    </data>
</openerp>